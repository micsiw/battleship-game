(()=>{"use strict";const e=e=>({name:e,turn:!1,ships:["Destroyer","Destroyer","Submarine","Cruiser","Battleship","Carrier"]}),o=e=>{let o=e,c=!1;return{getHealth:()=>o,getSize:()=>e,hit:()=>{o-=1},isSunk:()=>(c=o<1,c)}},c={Carrier:o(5),Battleship:o(4),Cruiser:o(3),Submarine:o(3),Destroyer:o(2)},t=100,l=()=>{const e=[];return function(o){for(let c=0;c<o;c++){const o={occupied:null,visited:!1};e.push(o)}}(t),{board:e,placeShip:(o,l,i=function(){return Math.random()<.5}())=>{console.log(o,l);const r=c[o],n=r.getSize(),u=i;console.log(`horizontal:${u}`);const d=[0,10,20,30,40,50,60,70,80,90,100],s=[100,101,102,103,104,105,106,107,108,109];function a(){if(!0===u){for(let e=1;e<n;e++)if(d.includes(l+e))return!1;for(let o=0;o<n;o++)if(l+o>=0&&l+o<t&&null!==e[l+o].occupied)return!1}else if(!1===u){let o=0;for(let e=0;e<n;e++){if(s.includes(l+o))return!1;o+=10}o=0;for(let c=0;c<n;c++)if(l+o>=0&&l+o<t){if(null!==e[l+o].occupied)return!1;o+=10}}return!0}if(!0===u&&!0===a()){[l+n-10,l+n+10,l+n,l-11,l-1,l+9].forEach(((o,c)=>{o>=0&&o<100&&(c<3&&!d.includes(o)&&(e[o].occupied="blocked"),c>2&&!d.map((e=>e-1)).includes(o)&&(e[o].occupied="blocked"))}));for(let o=0;o<n;o++){const c=[l+o+10,l+o-10];e[l+o].occupied=r,c.forEach((o=>{o>=0&&o<100&&(e[o].occupied="blocked")}))}return!0}if(!1===u&&!0===a()){[l-9,l+10*n+1,l-11,l+10*n-1,l-10,l+10*n].forEach(((o,c)=>{o>=0&&o<100&&(c<2&&!d.includes(o)&&(e[o].occupied="blocked"),c>1&&c<4&&!d.map((e=>e-1)).includes(o)&&(e[o].occupied="blocked"),c>3&&(e[o].occupied="blocked"))}));let o=0;for(let c=0;c<n;c++){const c=[l+o+1,l+o-1];e[l+o].occupied=r,c.forEach(((o,c)=>{o>=0&&o<100&&(0!==c||d.includes(o)||(e[o].occupied="blocked"),1!==c||d.map((e=>e-1)).includes(o)||(e[o].occupied="blocked"))})),o+=10}return!0}return!1},receiveAttack:o=>{!0===e[o].visited&&console.log("Field was already used"),null!==e[o].occupied&&(console.log("Ship was striked"),e[o].occupied.hit()),e[o].visited=!0},areAllSunk:()=>{let o=!0;return e.forEach((e=>{null!==e.occupied&&"blocked"!==e.occupied&&!1===e.occupied.isSunk()&&(o=!1)})),o}}};function i(e){const o=document.querySelector(".gameboards"),c=document.createElement("div");c.style.display="grid",c.style.gridTemplateColumns=`repeat(${Math.sqrt(t)}, 1fr)`,e.board.forEach(((e,o)=>{const t=document.createElement("div");t.classList.add("field"),t.dataset.field=o,null!==e.occupied&&"blocked"!==e.occupied&&(t.style.backgroundColor="yellow"),"blocked"===e.occupied&&(t.style.backgroundColor="pink"),c.appendChild(t)})),o.appendChild(c)}function r(e,o){const c=e.ships,l=e.ships.length;for(let e=0;e<l;e++){const l=c.pop(),i=Math.floor(Math.random()*t),r=o.placeShip(l,i);!1===r&&(c.push(l),e-=1),console.log(`ship allowed:${r}`)}}!function(){const o=e("Player"),c=e("Computer"),t=l(),n=l();r(o,t),r(c,n),i(t),i(n)}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUYsRUFBTy9ELE1BQU1rRSxPQUVoQyxJQUFLLElBQUluRCxFQUFJLEVBQUdBLEVBQUlrRCxFQUFZbEQsSUFBSyxDQUNuQyxNQUFNb0QsRUFBV0gsRUFBWUksTUFDdkJDLEVBQW9CNUMsS0FBSzZDLE1BQU03QyxLQUFLQyxTQUFXekIsR0FDL0NvQixFQUFZUixFQUFNUSxVQUFVOEMsRUFBVUUsSUFDMUIsSUFBZGhELElBQ0YyQyxFQUFZN0MsS0FBS2dELEdBQ2pCcEQsR0FBSyxHQUVQYSxRQUFRQyxJQUFJLGdCQUFnQlIsSUFDOUIsQ0FDRixFQUVBLFdBQ0UsTUFBTTBDLEVBQVMsRUFBTyxVQUNoQlEsRUFBVyxFQUFPLFlBRWxCQyxFQUFjLElBQ2RDLEVBQWdCLElBRXRCWCxFQUFtQkMsRUFBUVMsR0FDM0JWLEVBQW1CUyxFQUFVRSxHQUU3QjNCLEVBQW9CMEIsR0FDcEIxQixFQUFvQjJCLEVBQ3RCLENDOUJBQyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC1nYW1lLy4vc3JjL21vZHVsZXMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAtZ2FtZS8uL3NyYy9tb2R1bGVzL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC1nYW1lLy4vc3JjL21vZHVsZXMvc2hpcFR5cGVzLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAtZ2FtZS8uL3NyYy9tb2R1bGVzL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLWdhbWUvLi9zcmMvbW9kdWxlcy9pbnRlcmZhY2UuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC1nYW1lLy4vc3JjL21vZHVsZXMvZ2FtZS1sb2dpYy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLWdhbWUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUGxheWVyID0gKG5hbWUpID0+IHtcbiAgY29uc3QgdHVybiA9IGZhbHNlO1xuICBjb25zdCBzaGlwcyA9IFtcbiAgICBcIkRlc3Ryb3llclwiLFxuICAgIFwiRGVzdHJveWVyXCIsXG4gICAgXCJTdWJtYXJpbmVcIixcbiAgICBcIkNydWlzZXJcIixcbiAgICBcIkJhdHRsZXNoaXBcIixcbiAgICBcIkNhcnJpZXJcIixcbiAgXTtcblxuICByZXR1cm4geyBuYW1lLCB0dXJuLCBzaGlwcyB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgUGxheWVyO1xuIiwiY29uc3QgU2hpcCA9IChzaXplKSA9PiB7XG4gIGxldCBoZWFsdGggPSBzaXplO1xuICBsZXQgc3VuayA9IGZhbHNlO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBoZWFsdGggLT0gMTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgaWYgKGhlYWx0aCA8IDEpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdW5rID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBzdW5rO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0SGVhbHRoOiAoKSA9PiBoZWFsdGgsXG4gICAgZ2V0U2l6ZTogKCkgPT4gc2l6ZSxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU2hpcDtcbiIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcblxuY29uc3QgdHlwZXMgPSB7XG4gIENhcnJpZXI6IFNoaXAoNSksXG4gIEJhdHRsZXNoaXA6IFNoaXAoNCksXG4gIENydWlzZXI6IFNoaXAoMyksXG4gIFN1Ym1hcmluZTogU2hpcCgzKSxcbiAgRGVzdHJveWVyOiBTaGlwKDIpLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgdHlwZXM7XG4iLCJpbXBvcnQgdHlwZXMgZnJvbSBcIi4vc2hpcFR5cGVzXCI7XG5cbmNvbnN0IHNpemUgPSAxMDA7XG5cbmZ1bmN0aW9uIGdldFJhbmRvbUJvb2xlYW4oKSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpIDwgMC41O1xufVxuXG5jb25zdCBHYW1lQm9hcmQgPSAoKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gW107XG5cbiAgZnVuY3Rpb24gaW5pdGlhbGl6ZShib2FyZFNpemUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkU2l6ZTsgaSsrKSB7XG4gICAgICBjb25zdCBmaWVsZCA9IHtcbiAgICAgICAgb2NjdXBpZWQ6IG51bGwsXG4gICAgICAgIHZpc2l0ZWQ6IGZhbHNlLFxuICAgICAgfTtcbiAgICAgIGJvYXJkLnB1c2goZmllbGQpO1xuICAgIH1cbiAgfVxuXG4gIGluaXRpYWxpemUoc2l6ZSk7XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKHR5cGUsIGNvb3JkaW5hdGVzLCBob3Jpem9udGFsID0gZ2V0UmFuZG9tQm9vbGVhbigpKSA9PiB7XG4gICAgY29uc29sZS5sb2codHlwZSwgY29vcmRpbmF0ZXMpO1xuICAgIGNvbnN0IHNoaXAgPSB0eXBlc1t0eXBlXTtcbiAgICBjb25zdCBzaGlwU2l6ZSA9IHNoaXAuZ2V0U2l6ZSgpO1xuICAgIGNvbnN0IGlzSG9yaXpvbnRhbCA9IGhvcml6b250YWw7XG4gICAgY29uc29sZS5sb2coYGhvcml6b250YWw6JHtpc0hvcml6b250YWx9YCk7XG5cbiAgICBjb25zdCBob3Jpem9udGFsQm9yZGVyID0gWzAsIDEwLCAyMCwgMzAsIDQwLCA1MCwgNjAsIDcwLCA4MCwgOTAsIDEwMF07XG4gICAgY29uc3QgdmVydGljYWxCb3JkZXIgPSBbMTAwLCAxMDEsIDEwMiwgMTAzLCAxMDQsIDEwNSwgMTA2LCAxMDcsIDEwOCwgMTA5XTtcblxuICAgIGZ1bmN0aW9uIGNoZWNrSWZDb29yZGluYXRlc1ZhbGlkKCkge1xuICAgICAgaWYgKGlzSG9yaXpvbnRhbCA9PT0gdHJ1ZSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBTaXplOyBpKyspIHtcbiAgICAgICAgICBpZiAoaG9yaXpvbnRhbEJvcmRlci5pbmNsdWRlcyhjb29yZGluYXRlcyArIGkpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwU2l6ZTsgaSsrKSB7XG4gICAgICAgICAgaWYgKGNvb3JkaW5hdGVzICsgaSA+PSAwICYmIGNvb3JkaW5hdGVzICsgaSA8IHNpemUpXG4gICAgICAgICAgICBpZiAoYm9hcmRbY29vcmRpbmF0ZXMgKyBpXS5vY2N1cGllZCAhPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGlzSG9yaXpvbnRhbCA9PT0gZmFsc2UpIHtcbiAgICAgICAgbGV0IHZlcnRpY2FsRmllbGRzID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwU2l6ZTsgaSsrKSB7XG4gICAgICAgICAgaWYgKHZlcnRpY2FsQm9yZGVyLmluY2x1ZGVzKGNvb3JkaW5hdGVzICsgdmVydGljYWxGaWVsZHMpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIHZlcnRpY2FsRmllbGRzICs9IDEwO1xuICAgICAgICB9XG4gICAgICAgIHZlcnRpY2FsRmllbGRzID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwU2l6ZTsgaSsrKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgY29vcmRpbmF0ZXMgKyB2ZXJ0aWNhbEZpZWxkcyA+PSAwICYmXG4gICAgICAgICAgICBjb29yZGluYXRlcyArIHZlcnRpY2FsRmllbGRzIDwgc2l6ZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgaWYgKGJvYXJkW2Nvb3JkaW5hdGVzICsgdmVydGljYWxGaWVsZHNdLm9jY3VwaWVkICE9PSBudWxsKVxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB2ZXJ0aWNhbEZpZWxkcyArPSAxMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChpc0hvcml6b250YWwgPT09IHRydWUgJiYgY2hlY2tJZkNvb3JkaW5hdGVzVmFsaWQoKSA9PT0gdHJ1ZSkge1xuICAgICAgY29uc3QgYnVmZmVyID0gW1xuICAgICAgICAvLyByaWdodCBzaWRlXG4gICAgICAgIGNvb3JkaW5hdGVzICsgc2hpcFNpemUgLSAxMCxcbiAgICAgICAgY29vcmRpbmF0ZXMgKyBzaGlwU2l6ZSArIDEwLFxuICAgICAgICBjb29yZGluYXRlcyArIHNoaXBTaXplLFxuICAgICAgICAvLyBsZWZ0IHNpZGVcbiAgICAgICAgY29vcmRpbmF0ZXMgLSAxMSxcbiAgICAgICAgY29vcmRpbmF0ZXMgLSAxLFxuICAgICAgICBjb29yZGluYXRlcyArIDksXG4gICAgICBdO1xuICAgICAgYnVmZmVyLmZvckVhY2goKGZpZWxkLCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAoZmllbGQgPj0gMCAmJiBmaWVsZCA8IDEwMCkge1xuICAgICAgICAgIGlmIChpbmRleCA8IDMgJiYgIWhvcml6b250YWxCb3JkZXIuaW5jbHVkZXMoZmllbGQpKVxuICAgICAgICAgICAgYm9hcmRbZmllbGRdLm9jY3VwaWVkID0gXCJibG9ja2VkXCI7XG4gICAgICAgICAgaWYgKGluZGV4ID4gMiAmJiAhaG9yaXpvbnRhbEJvcmRlci5tYXAoKHgpID0+IHggLSAxKS5pbmNsdWRlcyhmaWVsZCkpXG4gICAgICAgICAgICBib2FyZFtmaWVsZF0ub2NjdXBpZWQgPSBcImJsb2NrZWRcIjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBTaXplOyBpKyspIHtcbiAgICAgICAgY29uc3QgYnVmZmVyRmllbGRzID0gW2Nvb3JkaW5hdGVzICsgaSArIDEwLCBjb29yZGluYXRlcyArIGkgLSAxMF07XG4gICAgICAgIGJvYXJkW2Nvb3JkaW5hdGVzICsgaV0ub2NjdXBpZWQgPSBzaGlwO1xuICAgICAgICBidWZmZXJGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgICBpZiAoZmllbGQgPj0gMCAmJiBmaWVsZCA8IDEwMCkgYm9hcmRbZmllbGRdLm9jY3VwaWVkID0gXCJibG9ja2VkXCI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBkb2tvbmN6IGxvZ2lrZSB6ZWJ5IGJ1ZmVyeSBzaWUgZG9icnplIHBvamF3aWFseVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGlzSG9yaXpvbnRhbCA9PT0gZmFsc2UgJiYgY2hlY2tJZkNvb3JkaW5hdGVzVmFsaWQoKSA9PT0gdHJ1ZSkge1xuICAgICAgY29uc3QgYnVmZmVyID0gW1xuICAgICAgICAvLyByaWdodCBzaWRlXG4gICAgICAgIGNvb3JkaW5hdGVzIC0gOSxcbiAgICAgICAgY29vcmRpbmF0ZXMgKyBzaGlwU2l6ZSAqIDEwICsgMSxcbiAgICAgICAgLy8gbGVmdCBzaWRlXG4gICAgICAgIGNvb3JkaW5hdGVzIC0gMTEsXG4gICAgICAgIGNvb3JkaW5hdGVzICsgc2hpcFNpemUgKiAxMCAtIDEsXG4gICAgICAgIC8vIHVwIGFuZCBkb3duXG4gICAgICAgIGNvb3JkaW5hdGVzIC0gMTAsXG4gICAgICAgIGNvb3JkaW5hdGVzICsgc2hpcFNpemUgKiAxMCxcbiAgICAgIF07XG4gICAgICBidWZmZXIuZm9yRWFjaCgoZmllbGQsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmIChmaWVsZCA+PSAwICYmIGZpZWxkIDwgMTAwKSB7XG4gICAgICAgICAgaWYgKGluZGV4IDwgMiAmJiAhaG9yaXpvbnRhbEJvcmRlci5pbmNsdWRlcyhmaWVsZCkpXG4gICAgICAgICAgICBib2FyZFtmaWVsZF0ub2NjdXBpZWQgPSBcImJsb2NrZWRcIjtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBpbmRleCA+IDEgJiZcbiAgICAgICAgICAgIGluZGV4IDwgNCAmJlxuICAgICAgICAgICAgIWhvcml6b250YWxCb3JkZXIubWFwKCh4KSA9PiB4IC0gMSkuaW5jbHVkZXMoZmllbGQpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBib2FyZFtmaWVsZF0ub2NjdXBpZWQgPSBcImJsb2NrZWRcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGluZGV4ID4gMykge1xuICAgICAgICAgICAgYm9hcmRbZmllbGRdLm9jY3VwaWVkID0gXCJibG9ja2VkXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxldCB2ZXJ0aWNhbEZpZWxkcyA9IDA7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBTaXplOyBpKyspIHtcbiAgICAgICAgY29uc3QgYnVmZmVyRmllbGRzID0gW1xuICAgICAgICAgIGNvb3JkaW5hdGVzICsgdmVydGljYWxGaWVsZHMgKyAxLFxuICAgICAgICAgIGNvb3JkaW5hdGVzICsgdmVydGljYWxGaWVsZHMgLSAxLFxuICAgICAgICBdO1xuICAgICAgICBib2FyZFtjb29yZGluYXRlcyArIHZlcnRpY2FsRmllbGRzXS5vY2N1cGllZCA9IHNoaXA7XG4gICAgICAgIGJ1ZmZlckZpZWxkcy5mb3JFYWNoKChmaWVsZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICBpZiAoZmllbGQgPj0gMCAmJiBmaWVsZCA8IDEwMCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwICYmICFob3Jpem9udGFsQm9yZGVyLmluY2x1ZGVzKGZpZWxkKSlcbiAgICAgICAgICAgICAgYm9hcmRbZmllbGRdLm9jY3VwaWVkID0gXCJibG9ja2VkXCI7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIGluZGV4ID09PSAxICYmXG4gICAgICAgICAgICAgICFob3Jpem9udGFsQm9yZGVyLm1hcCgoeCkgPT4geCAtIDEpLmluY2x1ZGVzKGZpZWxkKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgICBib2FyZFtmaWVsZF0ub2NjdXBpZWQgPSBcImJsb2NrZWRcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2ZXJ0aWNhbEZpZWxkcyArPSAxMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGlmIChib2FyZFtjb29yZGluYXRlc10udmlzaXRlZCA9PT0gdHJ1ZSkge1xuICAgICAgY29uc29sZS5sb2coXCJGaWVsZCB3YXMgYWxyZWFkeSB1c2VkXCIpO1xuICAgIH1cbiAgICBpZiAoYm9hcmRbY29vcmRpbmF0ZXNdLm9jY3VwaWVkICE9PSBudWxsKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlNoaXAgd2FzIHN0cmlrZWRcIik7XG4gICAgICBib2FyZFtjb29yZGluYXRlc10ub2NjdXBpZWQuaGl0KCk7XG4gICAgfVxuICAgIGJvYXJkW2Nvb3JkaW5hdGVzXS52aXNpdGVkID0gdHJ1ZTtcbiAgfTtcblxuICBjb25zdCBhcmVBbGxTdW5rID0gKCkgPT4ge1xuICAgIGxldCBhcmVTdW5rID0gdHJ1ZTtcbiAgICBib2FyZC5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBmaWVsZC5vY2N1cGllZCAhPT0gbnVsbCAmJlxuICAgICAgICBmaWVsZC5vY2N1cGllZCAhPT0gXCJibG9ja2VkXCIgJiZcbiAgICAgICAgZmllbGQub2NjdXBpZWQuaXNTdW5rKCkgPT09IGZhbHNlXG4gICAgICApIHtcbiAgICAgICAgYXJlU3VuayA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBhcmVTdW5rO1xuICB9O1xuXG4gIHJldHVybiB7IGJvYXJkLCBwbGFjZVNoaXAsIHJlY2VpdmVBdHRhY2ssIGFyZUFsbFN1bmsgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEdhbWVCb2FyZDtcbmV4cG9ydCB7IHNpemUgfTtcbiIsImltcG9ydCB7IHNpemUgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuZnVuY3Rpb24gaW5pdGlhbGl6ZUdhbWVCb2FyZChib2FyZCkge1xuICBjb25zdCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FtZWJvYXJkc1wiKTtcbiAgY29uc3QgbmV3Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gIG5ld0JvYXJkLnN0eWxlLmRpc3BsYXkgPSBcImdyaWRcIjtcbiAgbmV3Qm9hcmQuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtNYXRoLnNxcnQoc2l6ZSl9LCAxZnIpYDtcblxuICBib2FyZC5ib2FyZC5mb3JFYWNoKChmaWVsZCwgaW5kZXgpID0+IHtcbiAgICBjb25zdCBkcmF3RmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGRyYXdGaWVsZC5jbGFzc0xpc3QuYWRkKFwiZmllbGRcIik7XG4gICAgZHJhd0ZpZWxkLmRhdGFzZXQuZmllbGQgPSBpbmRleDtcbiAgICBpZiAoZmllbGQub2NjdXBpZWQgIT09IG51bGwgJiYgZmllbGQub2NjdXBpZWQgIT09IFwiYmxvY2tlZFwiKVxuICAgICAgZHJhd0ZpZWxkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwieWVsbG93XCI7XG4gICAgaWYgKGZpZWxkLm9jY3VwaWVkID09PSBcImJsb2NrZWRcIikgZHJhd0ZpZWxkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicGlua1wiO1xuICAgIG5ld0JvYXJkLmFwcGVuZENoaWxkKGRyYXdGaWVsZCk7XG4gIH0pO1xuXG4gIGJvYXJkQ29udGFpbmVyLmFwcGVuZENoaWxkKG5ld0JvYXJkKTtcbn1cblxuZXhwb3J0IHsgaW5pdGlhbGl6ZUdhbWVCb2FyZCB9O1xuIiwiaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBHYW1lQm9hcmQsIHsgc2l6ZSB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZUdhbWVCb2FyZCB9IGZyb20gXCIuL2ludGVyZmFjZVwiO1xuXG5mdW5jdGlvbiByYW5kb21seVBsYWNlU2hpcHMocGxheWVyLCBib2FyZCkge1xuICBjb25zdCBwbGF5ZXJTaGlwcyA9IHBsYXllci5zaGlwcztcbiAgY29uc3Qgc2hpcHNDb3VudCA9IHBsYXllci5zaGlwcy5sZW5ndGg7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwc0NvdW50OyBpKyspIHtcbiAgICBjb25zdCBzaGlwTmFtZSA9IHBsYXllclNoaXBzLnBvcCgpO1xuICAgIGNvbnN0IHJhbmRvbUNvb3JkaW5hdGVzID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2l6ZSk7XG4gICAgY29uc3QgcGxhY2VTaGlwID0gYm9hcmQucGxhY2VTaGlwKHNoaXBOYW1lLCByYW5kb21Db29yZGluYXRlcyk7XG4gICAgaWYgKHBsYWNlU2hpcCA9PT0gZmFsc2UpIHtcbiAgICAgIHBsYXllclNoaXBzLnB1c2goc2hpcE5hbWUpO1xuICAgICAgaSAtPSAxO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhgc2hpcCBhbGxvd2VkOiR7cGxhY2VTaGlwfWApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGluaXRpYWxpemVHYW1lKCkge1xuICBjb25zdCBwbGF5ZXIgPSBQbGF5ZXIoXCJQbGF5ZXJcIik7XG4gIGNvbnN0IG9wcG9uZW50ID0gUGxheWVyKFwiQ29tcHV0ZXJcIik7XG5cbiAgY29uc3QgcGxheWVyQm9hcmQgPSBHYW1lQm9hcmQoKTtcbiAgY29uc3Qgb3Bwb25lbnRCb2FyZCA9IEdhbWVCb2FyZCgpO1xuXG4gIHJhbmRvbWx5UGxhY2VTaGlwcyhwbGF5ZXIsIHBsYXllckJvYXJkKTtcbiAgcmFuZG9tbHlQbGFjZVNoaXBzKG9wcG9uZW50LCBvcHBvbmVudEJvYXJkKTtcblxuICBpbml0aWFsaXplR2FtZUJvYXJkKHBsYXllckJvYXJkKTtcbiAgaW5pdGlhbGl6ZUdhbWVCb2FyZChvcHBvbmVudEJvYXJkKTtcbn1cblxuZXhwb3J0IHsgaW5pdGlhbGl6ZUdhbWUgfTtcbiIsImltcG9ydCB7IGluaXRpYWxpemVHYW1lIH0gZnJvbSBcIi4vbW9kdWxlcy9nYW1lLWxvZ2ljXCI7XG5cbmluaXRpYWxpemVHYW1lKCk7XG4iXSwibmFtZXMiOlsibmFtZSIsInR1cm4iLCJzaGlwcyIsInNpemUiLCJoZWFsdGgiLCJzdW5rIiwiZ2V0SGVhbHRoIiwiZ2V0U2l6ZSIsImhpdCIsImlzU3VuayIsIkNhcnJpZXIiLCJCYXR0bGVzaGlwIiwiQ3J1aXNlciIsIlN1Ym1hcmluZSIsIkRlc3Ryb3llciIsImJvYXJkIiwiYm9hcmRTaXplIiwiaSIsImZpZWxkIiwib2NjdXBpZWQiLCJ2aXNpdGVkIiwicHVzaCIsImluaXRpYWxpemUiLCJwbGFjZVNoaXAiLCJ0eXBlIiwiY29vcmRpbmF0ZXMiLCJob3Jpem9udGFsIiwiTWF0aCIsInJhbmRvbSIsImdldFJhbmRvbUJvb2xlYW4iLCJjb25zb2xlIiwibG9nIiwic2hpcCIsInNoaXBTaXplIiwiaXNIb3Jpem9udGFsIiwiaG9yaXpvbnRhbEJvcmRlciIsInZlcnRpY2FsQm9yZGVyIiwiY2hlY2tJZkNvb3JkaW5hdGVzVmFsaWQiLCJpbmNsdWRlcyIsInZlcnRpY2FsRmllbGRzIiwiZm9yRWFjaCIsImluZGV4IiwibWFwIiwieCIsImJ1ZmZlckZpZWxkcyIsInJlY2VpdmVBdHRhY2siLCJhcmVBbGxTdW5rIiwiYXJlU3VuayIsImluaXRpYWxpemVHYW1lQm9hcmQiLCJib2FyZENvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm5ld0JvYXJkIiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwiZGlzcGxheSIsImdyaWRUZW1wbGF0ZUNvbHVtbnMiLCJzcXJ0IiwiZHJhd0ZpZWxkIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGF0YXNldCIsImJhY2tncm91bmRDb2xvciIsImFwcGVuZENoaWxkIiwicmFuZG9tbHlQbGFjZVNoaXBzIiwicGxheWVyIiwicGxheWVyU2hpcHMiLCJzaGlwc0NvdW50IiwibGVuZ3RoIiwic2hpcE5hbWUiLCJwb3AiLCJyYW5kb21Db29yZGluYXRlcyIsImZsb29yIiwib3Bwb25lbnQiLCJwbGF5ZXJCb2FyZCIsIm9wcG9uZW50Qm9hcmQiLCJpbml0aWFsaXplR2FtZSJdLCJzb3VyY2VSb290IjoiIn0=